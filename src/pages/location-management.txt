--- D:\WATATECH\WH\src\pages\location-management\LocationManagementPage.tsx ---

// Path: src/pages/location-management/LocationManagementPage.tsx

import { useState, useEffect, useCallback } from "react";
import LocationTree from "./components/LocationTree";
import LocationDetail from "./components/LocationDetail";
import PageHeader from "./components/PageHeader";
import LocationFormModal from "./components/LocationFormModal";
import TreeSkeleton from "./components/skeletons/TreeSkeleton";
import DetailSkeleton from "./components/skeletons/DetailSkeleton";
import type { LocationNode } from "./types";
import { warehouseData } from "./data";

// --- Thêm các hàm helper để xử lý cây dữ liệu một cách bất biến (immutable) ---

// Tìm và cập nhật một node trong cây
const updateNodeInTree = (
  node: LocationNode,
  updatedNode: Partial<LocationNode>
): LocationNode => {
  if (node.id === updatedNode.id) {
    return {
      ...node,
      ...updatedNode,
      items: node.items,
      children: node.children,
    };
  }
  return {
    ...node,
    children: node.children.map((child) =>
      updateNodeInTree(child, updatedNode)
    ),
  };
};

// Tìm và thêm một node con mới vào cây
const addNodeToTree = (
  node: LocationNode,
  parentId: string,
  newNode: LocationNode
): LocationNode => {
  if (node.id === parentId) {
    return { ...node, children: [...node.children, newNode] };
  }
  return {
    ...node,
    children: node.children.map((child) =>
      addNodeToTree(child, parentId, newNode)
    ),
  };
};

const findNodeById = (node: LocationNode, id: string): LocationNode | null => {
  if (node.id === id) return node;
  for (const child of node.children) {
    const found = findNodeById(child, id);
    if (found) return found;
  }
  return null;
};

const LocationManagementPage = () => {
  const [locations, setLocations] = useState<LocationNode | null>(null);
  const [selectedNodeId, setSelectedNodeId] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  // State quản lý modal
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [modalInitialData, setModalInitialData] = useState<LocationNode | null>(
    null
  );
  const [modalParentId, setModalParentId] = useState<string | null>(null);

  const selectedLocation =
    selectedNodeId && locations
      ? findNodeById(locations, selectedNodeId)
      : null;

  useEffect(() => {
    setIsLoading(true);
    setTimeout(() => {
      setLocations(warehouseData);
      setSelectedNodeId(warehouseData.id);
      setIsLoading(false);
    }, 1000);
  }, []);

  const handleSelectNode = useCallback((nodeId: string) => {
    setSelectedNodeId(nodeId);
  }, []);

  const handleOpenAddModal = (parentId: string | null = null) => {
    setModalInitialData(null);
    setModalParentId(parentId);
    setIsModalOpen(true);
  };

  const handleOpenEditModal = (location: LocationNode) => {
    setModalInitialData(location);
    setModalParentId(null);
    setIsModalOpen(true);
  };

  const handleCloseModal = () => {
    setIsModalOpen(false);
    setModalInitialData(null);
    setModalParentId(null);
  };

  const handleSaveLocation = (
    data: Partial<LocationNode> & { parentId?: string | null }
  ) => {
    if (!locations) return;

    if (data.parentId) {
      // Thêm mới
      const newNode: LocationNode = {
        id: data.id!,
        name: data.name!,
        type: data.type!,
        status: data.status!,
        capacity: data.capacity,
        items: [],
        children: [],
      };
      const updatedTree = addNodeToTree(locations, data.parentId, newNode);
      setLocations(updatedTree);
    } else {
      // Cập nhật
      const updatedTree = updateNodeInTree(locations, data);
      setLocations(updatedTree);
    }

    handleCloseModal();
  };

  if (isLoading || !locations) {
    return (
      <div className="p-6 bg-gray-50 min-h-full">
        <div className="bg-white p-4 rounded-lg shadow-sm mb-6 h-24 animate-pulse"></div>
        <div
          className="grid grid-cols-1 lg:grid-cols-3 gap-6"
          style={{ height: "calc(100vh - 160px)" }}
        >
          <div className="lg:col-span-1">
            <TreeSkeleton />
          </div>
          <div className="lg:col-span-2">
            <DetailSkeleton />
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="p-6 bg-gray-50 min-h-full">
      <PageHeader onAddRootLocation={() => handleOpenAddModal(locations.id)} />

      <div
        className="grid grid-cols-1 lg:grid-cols-3 gap-6"
        style={{ height: "calc(100vh - 160px)" }}
      >
        <div className="lg:col-span-1">
          <LocationTree
            data={locations}
            selectedNodeId={selectedNodeId}
            onSelectNode={handleSelectNode}
          />
        </div>

        <div className="lg:col-span-2">
          <LocationDetail
            location={selectedLocation}
            onEdit={handleOpenEditModal}
            onAddChild={() =>
              selectedNodeId && handleOpenAddModal(selectedNodeId)
            }
          />
        </div>
      </div>

      <LocationFormModal
        isOpen={isModalOpen}
        onClose={handleCloseModal}
        onSave={handleSaveLocation}
        initialData={modalInitialData}
        parentId={modalParentId}
      />
    </div>
  );
};

export default LocationManagementPage;


--- D:\WATATECH\WH\src\pages\location-management\components\LocationDetail.tsx ---

// Path: src/pages/location-management/components/LocationDetail.tsx

import React from "react";
import type { LocationNode, LocationStatus } from "../types";
import { Button } from "../../../components/ui/button"; // Giả sử bạn có component Button chung

const StatusBadge: React.FC<{ status: LocationStatus }> = ({ status }) => {
  const baseClasses = "px-2.5 py-0.5 text-xs font-semibold rounded-full";
  const colorClasses =
    status === "ACTIVE"
      ? "bg-green-100 text-green-800"
      : "bg-yellow-100 text-yellow-800";
  return (
    <span className={`${baseClasses} ${colorClasses}`}>
      {status === "ACTIVE" ? "Hoạt động" : "Tạm khóa"}
    </span>
  );
};

interface LocationDetailProps {
  location: LocationNode | null;
  onEdit: (location: LocationNode) => void;
  onAddChild: (parentId: string) => void;
}

const LocationDetail: React.FC<LocationDetailProps> = ({ 
  location,
  onEdit,
  onAddChild,
}) => {
  if (!location) {
    return (
      <div className="bg-white p-6 rounded-lg shadow-sm h-full flex items-center justify-center">
        <div className="text-center">
          <p className="text-gray-500">
            Chọn một vị trí từ cây cấu trúc để xem chi tiết.
          </p>
        </div>
      </div>
    );
  }

  const usagePercentage = location.capacity
    ? (location.items.length / location.capacity) * 100
    : 0;

  return (
    <div className="bg-white p-6 rounded-lg shadow-sm h-full overflow-y-auto">
      <div className="flex justify-between items-start mb-4">
        <div>
          <h2 className="text-xl font-bold text-gray-800">{location.name}</h2>
          <p className="text-sm text-gray-500">Mã vị trí: {location.id}</p>
        </div>
        <StatusBadge status={location.status} />
      </div>

      <div className="space-y-4">
        <div className="flex justify-end space-x-2">
          <Button variant="outline" onClick={() => onAddChild(location.id)}>
            Thêm vị trí con
          </Button>
          <Button onClick={() => onEdit(location)}>Sửa</Button>
        </div>

        {/* Thông tin chi tiết */}
        <div className="border-t pt-4">
          <h3 className="font-semibold mb-2">Thông tin chi tiết</h3>
          <dl className="grid grid-cols-2 gap-x-4 gap-y-2">
            <dt className="text-sm font-medium text-gray-500">Loại vị trí</dt>
            <dd className="text-sm text-gray-900">{location.type}</dd>
            <dt className="text-sm font-medium text-gray-500">Sức chứa</dt>
            <dd className="text-sm text-gray-900">
              {location.capacity || "Không giới hạn"}
            </dd>
          </dl>
        </div>

        {/* Sức chứa */}
        {location.capacity && (
          <div className="border-t pt-4">
            <h3 className="font-semibold mb-2">Tình trạng sử dụng</h3>
            <div className="w-full bg-gray-200 rounded-full h-2.5">
              <div
                className="bg-blue-600 h-2.5 rounded-full"
                style={{ width: `${usagePercentage}%` }}
              ></div>
            </div>
            <p className="text-sm text-right mt-1 text-gray-600">
              {location.items.length} / {location.capacity} (
              {usagePercentage.toFixed(1)}%)
            </p>
          </div>
        )}

        {/* Danh sách mặt hàng */}
        <div className="border-t pt-4">
          <h3 className="font-semibold mb-2">
            Hàng hóa trong vị trí ({location.items.length})
          </h3>
          {location.items.length > 0 ? (
            <ul className="divide-y divide-gray-200">
              {location.items.map((item) => (
                <li
                  key={item.id}
                  className="py-2 flex justify-between items-center"
                >
                  <div>
                    <p className="font-medium text-gray-800">{item.name}</p>
                    <p className="text-sm text-gray-500">SKU: {item.sku}</p>
                  </div>
                  <p className="text-gray-700">
                    {item.quantity} {item.uom}
                  </p>
                </li>
              ))}
            </ul>
          ) : (
            <p className="text-sm text-gray-500">Vị trí này đang trống.</p>
          )}
        </div>
      </div>
    </div>
  );
};

export default LocationDetail;


--- D:\WATATECH\WH\src\pages\location-management\components\LocationFormModal.tsx ---

// Path: src/pages/location-management/components/LocationFormModal.tsx

import React, { useState, useEffect } from "react";
import { X } from "lucide-react";
import type { LocationNode, LocationType, LocationStatus } from "../types";
import { Button } from "../../../components/ui/button"; // Giả sử bạn có component Button chung

interface LocationFormModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSave: (
    locationData: Partial<LocationNode> & { parentId?: string | null }
  ) => void;
  initialData?: LocationNode | null;
  parentId?: string | null;
}

const LocationFormModal: React.FC<LocationFormModalProps> = ({ 
  isOpen,
  onClose,
  onSave,
  initialData,
  parentId,
}) => {
  const [name, setName] = useState("");
  const [type, setType] = useState<LocationType>("BIN");
  const [status, setStatus] = useState<LocationStatus>("ACTIVE");
  const [capacity, setCapacity] = useState<number | "">("");

  const isEditing = !!initialData;

  useEffect(() => {
    if (isOpen && initialData) {
      setName(initialData.name);
      setType(initialData.type);
      setStatus(initialData.status);
      setCapacity(initialData.capacity || "");
    } else if (isOpen && !initialData) {
      // Reset form for adding new
      setName("");
      setType("BIN");
      setStatus("ACTIVE");
      setCapacity("");
    }
  }, [isOpen, initialData]);

  if (!isOpen) return null;

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (!name) {
      alert("Tên vị trí là bắt buộc.");
      return;
    }
    onSave({
      id: isEditing ? initialData!.id : Date.now().toString(), // Use existing ID or generate a new one for new item
      name,
      type,
      status,
      capacity: capacity ? Number(capacity) : undefined,
      parentId: isEditing ? undefined : parentId,
    });
  };

  const locationTypes: LocationType[] = [
    "WAREHOUSE",
    "ZONE",
    "AISLE",
    "SHELF",
    "BIN",
  ];

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center">
      <div className="bg-white rounded-lg shadow-xl w-full max-w-md m-4">
        <form onSubmit={handleSubmit}>
          {/* Header */}
          <div className="flex justify-between items-center p-4 border-b">
            <h2 className="text-lg font-semibold">
              {isEditing ? "Chỉnh sửa Vị trí" : "Thêm Vị trí Mới"}
            </h2>
            <Button variant="ghost" size="icon" type="button" onClick={onClose}>
              <X className="h-4 w-4" />
            </Button>
          </div>

          {/* Body */}
          <div className="p-6 space-y-4">
            <div>
              <label
                htmlFor="name"
                className="block text-sm font-medium text-gray-700"
              >
                Tên vị trí *
              </label>
              <input
                id="name"
                type="text"
                value={name}
                onChange={(e) => setName(e.target.value)}
                className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                required
              />
            </div>
            <div>
              <label
                htmlFor="type"
                className="block text-sm font-medium text-gray-700"
              >
                Loại vị trí
              </label>
              <select
                id="type"
                value={type}
                onChange={(e) => setType(e.target.value as LocationType)}
                className="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
              >
                {locationTypes.map((t) => (
                  <option key={t} value={t}>
                    {t}
                  </option>
                ))}
              </select>
            </div>
            <div>
              <label
                htmlFor="status"
                className="block text-sm font-medium text-gray-700"
              >
                Trạng thái
              </label>
              <select
                id="status"
                value={status}
                onChange={(e) => setStatus(e.target.value as LocationStatus)}
                className="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
              >
                <option value="ACTIVE">Hoạt động</option>
                <option value="LOCKED">Tạm khóa</option>
              </select>
            </div>
            <div>
              <label
                htmlFor="capacity"
                className="block text-sm font-medium text-gray-700"
              >
                Sức chứa (tùy chọn)
              </label>
              <input
                id="capacity"
                type="number"
                value={capacity}
                onChange={(e) =>
                  setCapacity(
                    e.target.value === "" ? "" : Number(e.target.value)
                  )
                }
                className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                min="0"
              />
            </div>
          </div>

          {/* Footer */}
          <div className="flex justify-end items-center p-4 border-t space-x-2">
            <Button variant="outline" type="button" onClick={onClose}>
              Hủy
            </Button>
            <Button type="submit">Lưu thay đổi</Button>
          </div>
        </form>
      </div>
    </div>
  );
};

export default LocationFormModal;


--- D:\WATATECH\WH\src\pages\location-management\components\LocationTree.tsx ---

// Path: src/pages/location-management/components/LocationTree.tsx

import React, { useState } from "react";
import type { LocationNode, LocationType } from "../types";
import {
  ChevronRight,
  ChevronDown,
  Warehouse,
  Folder,
  Rows,
  Archive,
  Box,
} from "lucide-react";

// Icon map
const typeIcons: Record<LocationType, React.ElementType> = {
  WAREHOUSE: Warehouse,
  ZONE: Folder,
  AISLE: Rows,
  SHELF: Archive,
  BIN: Box,
};

interface TreeNodeProps {
  node: LocationNode;
  selectedNodeId: string | null;
  onSelect: (nodeId: string) => void;
  level: number;
}

const TreeNode: React.FC<TreeNodeProps> = ({ 
  node,
  selectedNodeId,
  onSelect,
  level,
}) => {
  const [isExpanded, setIsExpanded] = useState(level < 2); // Mặc định mở 2 cấp đầu
  const hasChildren = node.children && node.children.length > 0;
  const IconComponent = typeIcons[node.type];

  const handleToggle = () => {
    if (hasChildren) {
      setIsExpanded(!isExpanded);
    }
  };

  const handleSelect = (e: React.MouseEvent) => {
    e.stopPropagation();
    onSelect(node.id);
  };

  const isSelected = selectedNodeId === node.id;

  return (
    <div>
      <div
        className={`flex items-center p-2 rounded-md cursor-pointer ${ 
          isSelected ? "bg-blue-100 text-blue-700" : "hover:bg-gray-100"
        }`}
        style={{ paddingLeft: `${level * 1.5}rem` }}
        onClick={handleSelect}
      >
        <div className="w-6" onClick={handleToggle}>
          {hasChildren &&
            (isExpanded ? (
              <ChevronDown size={16} />
            ) : (
              <ChevronRight size={16} />
            ))}
        </div>
        <IconComponent className="w-5 h-5 mr-2 text-gray-500" />
        <span className="flex-grow font-medium">{node.name}</span>
      </div>
      {isExpanded && hasChildren && (
        <div className="pl-4 border-l-2 border-gray-200 ml-5">
          {node.children.map((child) => (
            <TreeNode
              key={child.id}
              node={child}
              selectedNodeId={selectedNodeId}
              onSelect={onSelect}
              level={level + 1}
            />
          ))}
        </div>
      )}
    </div>
  );
};

interface LocationTreeProps {
  data: LocationNode;
  selectedNodeId: string | null;
  onSelectNode: (nodeId: string) => void;
}

const LocationTree: React.FC<LocationTreeProps> = ({ 
  data,
  selectedNodeId,
  onSelectNode,
}) => {
  return (
    <div className="bg-white p-4 rounded-lg shadow-sm h-full overflow-y-auto">
      <h2 className="text-lg font-semibold mb-4 text-gray-800">Cấu trúc kho</h2>
      <TreeNode
        node={data}
        selectedNodeId={selectedNodeId}
        onSelect={onSelectNode}
        level={0}
      />
    </div>
  );
};

export default LocationTree;


--- D:\WATATECH\WH\src\pages\location-management\components\PageHeader.tsx ---

// Path: src/pages/location-management/components/PageHeader.tsx
import React from "react";
import { Plus } from "lucide-react";
import { Button } from "../../../components/ui/button"; // Giả sử bạn có component này

interface PageHeaderProps {
  onAddRootLocation: () => void;
}

const PageHeader: React.FC<PageHeaderProps> = ({ onAddRootLocation }) => {
  return (
    <div className="bg-white p-4 rounded-lg shadow-sm mb-6">
      <div className="flex justify-between items-center">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">
            Quản lý Vị trí Kho
          </h1>
          <p className="text-sm text-gray-500">
            Thiết lập, quản lý và xem xét sơ đồ logic của kho hàng.
          </p>
        </div>
        <Button onClick={onAddRootLocation}>
          <Plus className="w-4 h-4 mr-2" />
          Thêm Vị trí Mới
        </Button>
      </div>
    </div>
  );
};

export default PageHeader;


--- D:\WATATECH\WH\src\pages\location-management\components\skeletons\DetailSkeleton.tsx ---

// Path: src/pages/location-management/components/skeletons/DetailSkeleton.tsx

const DetailSkeleton = () => {
  return (
    <div className="bg-white p-6 rounded-lg shadow-sm h-full overflow-y-auto animate-pulse">
      {/* Header */}
      <div className="flex justify-between items-start mb-4">
        <div>
          <div className="h-7 w-48 bg-gray-300 rounded-md mb-2"></div>
          <div className="h-4 w-32 bg-gray-200 rounded-md"></div>
        </div>
        <div className="h-6 w-20 bg-gray-200 rounded-full"></div>
      </div>

      {/* Action Buttons */}
      <div className="flex justify-end space-x-2 mb-4">
        <div className="h-10 w-32 bg-gray-200 rounded-md"></div>
        <div className="h-10 w-20 bg-gray-300 rounded-md"></div>
      </div>

      {/* Details */}
      <div className="border-t pt-4 space-y-3">
        <div className="h-5 w-24 bg-gray-300 rounded-md"></div>
        <div className="grid grid-cols-2 gap-x-4 gap-y-3">
          <div className="h-4 w-20 bg-gray-200 rounded-md"></div>
          <div className="h-4 w-28 bg-gray-200 rounded-md"></div>
          <div className="h-4 w-24 bg-gray-200 rounded-md"></div>
          <div className="h-4 w-36 bg-gray-200 rounded-md"></div>
        </div>
      </div>

      {/* Usage */}
      <div className="border-t pt-4 mt-4 space-y-3">
        <div className="h-5 w-32 bg-gray-300 rounded-md"></div>
        <div className="w-full bg-gray-200 rounded-full h-2.5"></div>
      </div>

      {/* Item List */}
      <div className="border-t pt-4 mt-4 space-y-3">
        <div className="h-5 w-40 bg-gray-300 rounded-md"></div>
        <div className="h-10 w-full bg-gray-200 rounded-md"></div>
        <div className="h-10 w-full bg-gray-200 rounded-md"></div>
      </div>
    </div>
  );
};

export default DetailSkeleton;


--- D:\WATATECH\WH\src\pages\location-management\components\skeletons\TreeSkeleton.tsx ---

// Path: src/pages/location-management/components/skeletons/TreeSkeleton.tsx

const SkeletonItem = ({ indent = 0 }: { indent?: number }) => (
  <div
    className="flex items-center p-2"
    style={{ paddingLeft: `${indent * 1.5 + 1}rem` }}
  >
    <div className="w-5 h-5 bg-gray-200 rounded-sm mr-2"></div>
    <div className="h-4 bg-gray-200 rounded-md w-3/4"></div>
  </div>
);

const TreeSkeleton = () => {
  return (
    <div className="bg-white p-4 rounded-lg shadow-sm h-full overflow-y-auto animate-pulse">
      <div className="h-6 w-1/3 bg-gray-300 rounded-md mb-4"></div>
      <div className="space-y-1">
        <SkeletonItem />
        <SkeletonItem indent={1} />
        <SkeletonItem indent={2} />
        <SkeletonItem indent={2} />
        <SkeletonItem indent={1} />
        <SkeletonItem />
        <SkeletonItem />
      </div>
    </div>
  );
};

export default TreeSkeleton;


--- D:\WATATECH\WH\src\pages\location-management\data.ts ---

// Path: src/pages/location-management/data.ts

import type { LocationNode } from './types';

export const warehouseData: LocationNode = {
  id: 'FBWH',
  name: 'Kho Vải (FBWH)',
  type: 'WAREHOUSE',
  status: 'ACTIVE',
  items: [],
  children: [
    {
      id: 'FBWH-A',
      name: 'Khu A',
      type: 'ZONE',
      status: 'ACTIVE',
      items: [],
      children: [
        {
          id: 'FBWH-A-01',
          name: 'Dãy 01',
          type: 'AISLE',
          status: 'ACTIVE',
          items: [],
          children: [
            {
              id: 'FBWH-A-01-S1',
              name: 'Kệ 01-S1',
              type: 'SHELF',
              status: 'ACTIVE',
              capacity: 10,
              items: [
                { id: 'ROLL-001', sku: 'FAB-001', name: 'Vải Cotton Xanh', quantity: 2, uom: 'Cây' },
                { id: 'ROLL-002', sku: 'FAB-002', name: 'Vải Kate Trắng', quantity: 3, uom: 'Cây' },
              ],
              children: [],
            },
            {
              id: 'FBWH-A-01-S2',
              name: 'Kệ 01-S2',
              type: 'SHELF',
              status: 'LOCKED',
              capacity: 10,
              items: [],
              children: [],
            },
          ],
        },
        {
          id: 'FBWH-A-02',
          name: 'Dãy 02',
          type: 'AISLE',
          status: 'ACTIVE',
          items: [],
          children: [],
        }
      ],
    },
    {
      id: 'FBWH-B',
      name: 'Khu B',
      type: 'ZONE',
      status: 'ACTIVE',
      items: [],
      children: [],
    }
  ],
};

--- D:\WATATECH\WH\src\pages\location-management\types.ts ---

// Path: src/pages/location-management/types.ts

// Loại của một vị trí trong kho
export type LocationType = 'WAREHOUSE' | 'ZONE' | 'AISLE' | 'SHELF' | 'BIN';

// Trạng thái của vị trí
export type LocationStatus = 'ACTIVE' | 'LOCKED';

// Một mặt hàng tồn kho đơn giản
export interface InventoryItem {
  id: string;
  sku: string;
  name: string;
  quantity: number;
  uom: string; // Đơn vị tính
}

// Cấu trúc một node (vị trí) trong cây kho
export interface LocationNode {
  id: string;
  name: string;
  type: LocationType;
  status: LocationStatus;
  capacity?: number; // Sức chứa (tùy chọn)
  items: InventoryItem[]; // Các mặt hàng đang có tại vị trí này
  children: LocationNode[]; // Các vị trí con
}



# File src/App.tsx
// Path: src/App.tsx

import { BrowserRouter, Routes, Route } from "react-router-dom";
import MainLayout from "./layouts/MainLayout";
import InboundDashboardPage from "./pages/inbound-dashboard/InboundDashboardPage";
import InventoryListPage from "./pages/inventory-list/InventoryListPage";
import KanbanBoardPage from "./pages/kanban-board/KanbanBoardPage";
import ImportPackingListFormPage from "./pages/import-packing-list/ImportPackingListFormPage";
import ShipmentDetailPage from "./pages/shipment-detail/ShipmentDetailPage";
import LocationManagementPage from "./pages/location-management/LocationManagementPage";
import QRScanInterfacePage from "./pages/qr-scan/QRScanInterfacePage";
import IssueFabricFormPage from "./pages/issue-fabric-form/IssueFabricFormPage";
import IssueAccessoryFormPage from "./pages/issue-accessory-form/IssueAccessoryFormPage";
import IssuePackagingFormPage from "./pages/issue-packaging-form/IssuePackagingFormPage";
import IssueTransactionReportsPage from "./pages/issue-transaction-reports/IssueTransactionReportsPage";
import PackingListManagementPage from "./pages/packing-list-management/PackingListManagementPage";

function App() {
  return (
    <BrowserRouter>
      <Routes>
        {/* Tất cả các route bên trong đây sẽ sử dụng MainLayout */}
        <Route path="/" element={<MainLayout />}>
          <Route index element={<InboundDashboardPage />} />
          <Route path="dashboard" element={<InboundDashboardPage />} />
          <Route path="inventory" element={<InventoryListPage />} />
          <Route path="kanban" element={<KanbanBoardPage />} />
          <Route
            path="import-packing-list"
            element={<ImportPackingListFormPage />}
          />
          <Route
            path="shipments/:shipmentId"
            element={<ShipmentDetailPage />}
          />
          <Route path="locations" element={<LocationManagementPage />} />
          <Route path="qr-scan" element={<QRScanInterfacePage />} />
          <Route path="issue/fabric" element={<IssueFabricFormPage />} />

          <Route path="issue/accessory" element={<IssueAccessoryFormPage />} />
          <Route path="issue/packaging" element={<IssuePackagingFormPage />} />

          <Route
            path="reports/issues"
            element={<IssueTransactionReportsPage />}
          />

          <Route path="packing-list" element={<PackingListManagementPage />} />
        </Route>

        {/* Bạn có thể thêm các route không cần layout ở đây, ví dụ trang Login */}
        {/* <Route path="/login" element={<LoginPage />} /> */}
      </Routes>
    </BrowserRouter>
  );
}

export default App;















# File src/layouts/MainLayout.tsx
// Path: src/layouts/MainLayout.tsx

import { useState } from "react";
import { NavLink, Outlet } from "react-router-dom";
import {
  Menu,
  X,
  LayoutDashboard,
  Truck,
  Bell,
  User,
  KanbanSquare,
  Network,
  QrCode,
  FileOutput,
  Boxes,
  Package,
  ScrollText,
  ListPlus,
  Upload,
} from "lucide-react";

const Sidebar = () => {
  // Style chung cho NavLink
  const linkClasses = "flex items-center px-4 py-2.5 rounded-lg";
  const inactiveClasses = "text-gray-300 hover:bg-gray-700";
  const activeClasses = "bg-gray-700 font-semibold text-white";

  return (
    <div className="bg-gray-800 text-white w-64 space-y-2 p-4 flex-shrink-0">
      <div className="text-2xl font-bold mb-6">Kho Hàng Pro</div>
      <nav>
        <NavLink
          to="/dashboard"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <LayoutDashboard className="w-5 h-5 mr-3" />
          Dashboard Hàng Nhập
        </NavLink>

        <NavLink
          to="/packing-list"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <ListPlus className="w-5 h-5 mr-3" />
          QL Packing List / In QR
        </NavLink>

        <NavLink
          to="/inventory" // <--- THAY ĐỔI LINK
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Truck className="w-5 h-5 mr-3" />
          Quản lý Tồn kho
        </NavLink>

        <NavLink
          to="/kanban"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <KanbanSquare className="w-5 h-5 mr-3" />
          Bảng Kanban
        </NavLink>

        <NavLink
          to="/shipments/7c3b9a1d"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Truck className="w-5 h-5 mr-3" />
          Chi tiết lô hàng
        </NavLink>

        <NavLink
          to="/locations"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Network className="w-5 h-5 mr-3" />
          Quản lý Vị trí
        </NavLink>

        <NavLink
          to="/qr-scan"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <QrCode className="w-5 h-5 mr-3" />
          Quét Mã QR
        </NavLink>

        <NavLink
          to="/issue/fabric"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <FileOutput className="w-5 h-5 mr-3" />
          Tạo Phiếu Xuất Vải
        </NavLink>

        <NavLink
          to="/issue/accessory" // <--- Route mới
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Boxes className="w-5 h-5 mr-3" />
          Tạo Phiếu Xuất Phụ liệu
        </NavLink>

        <NavLink
          to="/issue/packaging"
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Package className="w-5 h-5 mr-3" />
          Tạo Phiếu Xuất Đóng Gói
        </NavLink>

        <NavLink
          to="/reports/issues" // <-- Route mới
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <ScrollText className="w-5 h-5 mr-3" />
          Báo cáo Xuất Kho
        </NavLink>

        <NavLink
          to="/import-packing-list" // <-- Route mới
          className={({ isActive }) =>
            `${linkClasses} ${isActive ? activeClasses : inactiveClasses}`
          }
        >
          <Upload className="w-5 h-5 mr-3" />
          Upfile Packing List
        </NavLink>
      </nav>
    </div>
  );
};

// Component Header đơn giản
const Header = ({ onMenuClick }: { onMenuClick: () => void }) => (
  <header className="bg-white border-b border-gray-200 p-4 flex justify-between items-center">
    {/* Nút Menu cho mobile */}
    <button onClick={onMenuClick} className="lg:hidden text-gray-600">
      <Menu className="w-6 h-6" />
    </button>
    <div className="hidden lg:block">
      {/* Placeholder, có thể là thanh search hoặc title */}
    </div>
    <div className="flex items-center space-x-4">
      <button className="text-gray-500 hover:text-gray-700">
        <Bell className="w-6 h-6" />
      </button>
      <div className="flex items-center space-x-2">
        <User className="w-8 h-8 rounded-full bg-gray-200 text-gray-500 p-1" />
        <span className="text-sm font-medium text-gray-700">Admin</span>
      </div>
    </div>
  </header>
);

const MainLayout = () => {
  const [sidebarOpen, setSidebarOpen] = useState(false);

  return (
    <div className="flex h-screen bg-gray-100">
      {/* Sidebar cho Desktop */}
      <div className="hidden lg:flex">
        <Sidebar />
      </div>

      {/* Sidebar cho Mobile (Overlay) */}
      {sidebarOpen && (
        <div className="lg:hidden fixed inset-0 flex z-40">
          <div
            className="fixed inset-0 bg-black opacity-30"
            onClick={() => setSidebarOpen(false)}
          ></div>
          <Sidebar />
          <button
            onClick={() => setSidebarOpen(false)}
            className="absolute top-4 right-4 text-white"
          >
            <X className="w-6 h-6" />
          </button>
        </div>
      )}

      {/* Main Content */}
      <div className="flex-1 flex flex-col overflow-hidden">
        <Header onMenuClick={() => setSidebarOpen(true)} />
        <main className="flex-1 overflow-x-hidden overflow-y-auto">
          {/* Đây là nơi các trang con sẽ được render */}
          <Outlet />
        </main>
      </div>
    </div>
  );
};

export default MainLayout;

