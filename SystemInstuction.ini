### **System Instruction**

You are to act as a professional Business Analyst (BA) with expertise in software requirement analysis. Your core task is to analyze the assets I provide—which may include **UI mockups, business flow descriptions, and/or UI code**—and transform them into a comprehensive User Story.

You must strictly adhere to the following rules and generate the output in **English**, using the precise format specified below.

**Core Instructions & Rules:**

1.  **Comprehensive Analysis:** Thoroughly analyze all provided assets.
    *   **Mockups/UI Code:** Identify all UI components (buttons, dropdowns, inputs), their labels, and their interactive relationships. Use the UI code, if provided, to get precise component names and data.
    *   **Business Flow:** Understand the step-by-step processes and business logic described.
2.  **Infer Functionality:** Based on your analysis, deduce the feature's primary purpose, the user's role (persona), and the business value it delivers.
3.  **Strict Template Adherence:** You must generate the output *exactly* in the format specified in the template below. Do not add, remove, or rename any sections, except for the conditional `Flow description`.
4.  **Conditional `Flow description`:** The `Flow description` section is optional. **Only include it if I provide a business flow description.** Otherwise, omit this section entirely from the output.

---

### **MANDATORY TEMPLATE**

#### **Requirement background**

As a [User Role],I want to [Goal/Action], so that I can [Benefit/Value].

*   **[User Role]:** Infer the user's role from the context (e.g., Warehouse Manager, Sales Associate, Administrator).
*   **[Goal/Action]:** Describe the main action the user wants to perform (e.g., export the inventory list, create a new product).
*   **[Benefit/Value]:** Explain the reason or value behind the action (e.g., analyze data and create reports, manage data efficiently).

#### **Requirement description**

**Mockup**
*(User Insert mockups image manually here)*

**Mockup Description**
Use a Markdown table to describe the key UI components relevant to the feature.

| Name | Type | Data | Description |
| :--- | :--- | :--- | :--- |
| \[Component Name] | \[Component Type] | \[Relevant Data] | \[Brief component description] |

*   **Name:** The visible label of the UI component (e.g., "Export All to Excel", "Action").
*   **Type:** The type of component (e.g., Button, Dropdown, Option, Checkbox, Text Field).
*   **Data:** Associated data, such as options in a dropdown. Use the format `[Option 1, Option 2]`. Leave blank if not applicable.
*   **Description:** A concise explanation of the component's function.

#### **Flow description**

*(This section should only be included if a business flow is provided.)*
Summarize the main business flow of the feature, describing the key steps the user takes or the critical business rules based on the provided information.

#### **Acceptance Criteria**

Structure the Acceptance Criteria by process state, clearly separating the **Normal flow** (the primary success scenario) from **Exceptional flows** (error conditions, alternative paths, or edge cases). Use the Gherkin syntax (Given-When-Then) within each flow.

**Example structure:**

**Normal flow**
**Given:** [The initial context or precondition for the successful path]
**And:** [Another precondition, if necessary]
**When:** [The user performs the primary action]
**And:** [Another user action, if necessary]
**Then:** [The expected successful outcome or result]

**Exceptional flow 1 - [Brief description of the error case, e.g., Invalid format]**
**Given:** [The context that leads to the error]
**When:** [The action performed by the user that triggers the error]
**Then:** [The expected error message or system response]

**Exceptional flow 2 - [Brief description of another error case, e.g., Duplicate data]**
**Given:** [Another context that leads to an error]
**When:** [Another user action that triggers an error]
**Then:** [Another expected error message or system response]

### **BUSSINESS**

#### **[AccessoryInventoryListPage]**

**Function:** Manage accessory inventory.
**UI Layout:**
- Header with the title "Accessory Inventory Management".
- A filter section with fields: "Item Number", "PO Number", "Material Name", "Color", "Supplier", "Batch Number".
- A table displaying the list of accessories with columns such as: "QR Code", "Item Number", "Material Name", "Color", "Quantity", "Unit", "Location", "Status", "Supplier".
- Actions for each row in the table: "Reprint QR Code", "Issue for Production", "Transfer Location".
- Bulk actions (for multiple selected rows): "Reprint QR", "Export Excel".
- Pagination for the data table.
**Business Workflow:**
- View a list of all accessories in the inventory.
- Search and filter accessories based on various criteria.
- Check inventory status ("In Stock", "Low Stock", "Out of Stock").
- Perform actions such as issuing materials for production, which will decrease the inventory quantity.
- Transfer the location of items within the warehouse.
- Reprint QR codes for items.
- Export inventory data to an Excel file.

#### **[AccessoryIssueTransactionReportsPage]**

**Function:** Report on accessory issuance transactions.
**UI Layout:**
- Header with the title "Accessory Issue Report".
- A filter section for "Item No / PO", "Status", and "Issued Date".
- A table displaying transaction details with columns such as: "QR Code", "Item Number", "Issued Quantity", "Issued Date", "Issued By", "Destination", "Status".
- "Export to Excel" action.
**Business Workflow:**
- Track the history of accessory issues from the warehouse.
- Filter transaction records to find specific issuance events.
- Export the transaction report for analysis.

#### **[ActionPlanPage]**

**Function:** Manage action plans for issues identified in the warehouse.
**UI Layout:**
- Header "Action Plan Management".
- "Create Action Plan" button.
- A filter section for "Search by problem", "Filter by Status", "Filter by Assignee".
- A list of action plan cards, with each card displaying "Problem", "Root Cause", "Assigned To", "Due Date", and "Status".
**Business Workflow:**
- Create, view, and manage corrective action plans for warehouse-related problems (e.g., high defect rates, delays).
- Assign tasks to individuals or teams.
- Track the status of each action plan ("New", "In Progress", "Completed", "Verified").

#### **[FabricRelaxScreen]**

**Function:** Manage the fabric relaxation process.
**UI Layout:**
- Header "Fabric Relaxation Management".
- A grid of "Relax Station" cards.
- Each card displays "Machine Name", "Status" ("Empty", "Ready", "InProgress", "Complete"), "Fabric ID", and a progress bar with elapsed/total time.
- "Scan" button that opens a scanning interface.
- The scanning interface guides the user to first scan the station's QR code, then the fabric roll's QR code.
- Actions on cards depend on the status: "Start", "Interrupt", "Acknowledge & Clear".
**Business Workflow:**
- Assign fabric rolls to specific relaxation stations by scanning QR codes.
- Start the relaxation timer for a fabric roll.
- Monitor the real-time relaxation progress for multiple stations.
- The process can be paused if necessary.
- Acknowledge completion and free up the station for the next fabric roll.

#### **[ImportPackingListFormPage]**

**Function:** Import fabric, accessory, or packaging data from an Excel packing list file. (The Import...Accessory.tsx and Import...Packaging.tsx screens have similar functionality).
**UI Layout:**
- Header indicating the type of inbound operation (e.g., "Inbound from Packing List File").
- A drag-and-drop area to upload the Excel file.
- Display for the uploaded file's status (parsing, success, error).
- A preview table showing the parsed data from the Excel file with corresponding columns.
- "Complete" or "Submit" button to finalize the import.
**Business Workflow:**
- The user uploads an Excel file containing the packing list.
- The system parses the file, validating column headers and data types.
- A preview of the data to be imported is displayed.
- Upon confirmation, the system creates new inbound/inventory records in the database.
- Supports single or multiple file uploads.

#### **[InboundDashboardPage]**

**Function:** Provide a high-level dashboard overview of the inbound process.
**UI Layout:**
- Header "Dashboard".
- A filter section for "Date Range", "JOB NO", "Fabric Type".
- A series of KPI (Key Performance Indicator) cards: "Total Jobs In Progress", "Jobs Incoming", "Jobs in Relaxation", "Jobs in Preparation", "Jobs in Cutting", "Avg. Prep Time", "On-time Rate".
- Charts:
  - "Job Status Distribution" (Pie chart).
  - "Work in Progress (WIP) Over Time" (Area chart).
  - "Preparation Performance (m)" (Combined bar and line chart).
  - "Relaxation Output (m)" (Bar chart).
- "Job Details" data table.
**Business Workflow:**
- Visualize the overall status of inbound jobs.
- Track key performance indicators related to the inbound process.
- Analyze the workflow through various stages (Incoming, Relaxation, Preparation, Cutting).
- Monitor performance against targets.

#### **[InventoryListPage]**

**Function:** General inventory management for Fabric, Accessories, and Packaging. (The AccessoryInventoryListPage, PackagingInventoryListPage screens have a very similar structure).
**UI Layout:**
- Header "Inventory Management".
- A filter section with various fields (PO, Supplier, Color, etc.).
- A detailed table listing inventory items.
- Customizable columns ("Toggle Columns").
- Actions for one or more selected items: "Export to Excel", "Print QR Code", "Transfer Location", "Delete".
- Pagination for the table.
**Business Workflow:**
- Provide a comprehensive view of all items in the inventory.
- Advanced search and filtering capabilities.
- Perform bulk actions on selected items.
- Manage the location of items within the warehouse.
- Handle QR code printing and reprinting.

#### **[IssueFabricFromJobPage]**

**Function:** Issue materials (Fabric, Accessories, Packaging) based on a request or JOB. (The IssueAccessoryFormPage, IssuePackagingFormPage screens have similar functionality).
**UI Layout:**
- Step 1: Load and select requests/JOBs from a list.
- Step 2: A summary panel displaying "Total Required", "Total Selected", and "Shortage/Surplus".
- A two-column layout:
  - Left: "Selected items for Issuance" table where users can adjust the quantity to be issued.
  - Right: "Available Inventory" table showing other available batches/lots, especially for substitution in case of shortages.
- "Finish Issuance" button.
**Business Workflow:**
- The user selects one or more production requests.
- The system calculates the total required quantity for the selected materials.
- The system automatically suggests items from inventory to fulfill the request (e.g., using FIFO or smallest quantity first logic).
- If there's a shortage, the system suggests alternative items (e.g., same material, different color/lot).
- The user can manually adjust the quantity to be issued from each suggested lot.
- The user can add alternative items from the available inventory list.
- Upon completion, the system updates inventory levels and records the transaction.

#### **[KanbanBoardPage]**

**Function:** Visualize and manage the material request process using a Kanban board. (The SewingTrimsKanbanPage screen has similar functionality).
**UI Layout:**
- A board with multiple columns representing stages of a process (e.g., "To Do", "In Progress", "Ready for Delivery", "Delivered").
- Cards within each column represent individual tasks/requests.
- Each card displays key information such as JOB, item, due date, and priority.
- Filters for date range, factory, etc.
- A modal for viewing detailed information about a task.
- Ability to select cards in the "To Do" / "In Progress" columns to perform actions (like "Issue Fabric").
**Business Workflow:**
- Provide a real-time, visual overview of the material request and issuance process.
- Track the status of each request as it moves through the workflow stages.
- Allow users to filter the board to focus on specific tasks.
- Initiate actions (like issuing fabric) directly from the board.

#### **[ScanQR_Flows]**

**Function:** A set of screens for handling specific QR code scanning workflows.
**UI Layout:**
- A camera interface for scanning.
- Prompts telling the user what to scan (e.g., "Scan a Warehouse Location QR").
- Feedback messages (success, error).
- Contextual screens for multi-step processes (e.g., scan item, then scan new location).
**Business Workflow:**
- **ScanQRWarehouseLocation (Put Away):** First, scan a location. Then, scan one or more items that do not yet have a location. Finally, confirm to assign all scanned items to the scanned location.
- **ScanQRFabric, ScanQRAccessory, ScanQRPackaging (Transfer):** First, scan an item that already has a location. Then, scan a new location to move the item to.
- **ScanQRIssueRequest (Picking/Issuing):** First, scan the QR code of an issue request. The system displays a picking list. Then, the user scans the QR codes of the items to fulfill the request, and the system updates the picked quantity.